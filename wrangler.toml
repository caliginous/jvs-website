name = "jvs-website"
compatibility_date = "2024-07-20"
compatibility_flags = ["nodejs_compat"]

# Custom Worker Configuration
# - Handles tickets routes directly to bypass Next.js Pages adapter Edge function issues
# - Delegates all other routes to Next.js Pages adapter
main = "worker.js"

[assets]
directory = ".vercel/output/static"

[[d1_databases]]
binding = "DB"
database_name = "jvs-magazine-db"
database_id = "2b2ca51b-2571-486a-b569-d595f75f9fd8"

[env.production]
name = "jvs-website"

# KV Namespace for storing sensitive data like Stripe keys
[[env.production.kv_namespaces]]
binding = "JVS_SECRETS"
id = "7628564cb1e947908e46a7a47373c23b"

[[env.production.d1_databases]]
binding = "DB"
database_name = "jvs-magazine-db"
database_id = "2b2ca51b-2571-486a-b569-d595f75f9fd8"

[env.production.vars]
WP_GRAPHQL_URL = "https://backend.jvs.org.uk/graphql"
WP_API_URL = "https://backend.jvs.org.uk/wp-json/wp/v2"
WP_USERNAME = "your_wordpress_username"
WP_PASSWORD = "your_wordpress_password"
ALLOWED_ORIGIN = "https://jvs.org.uk"
STRIPE_PUBLISHABLE_KEY = "pk_live_tUaoofuGHYYKl2YZprc5oEBs"
NEXT_PUBLIC_UNIFIED_EVENTS = "true"
MAILCHIMP_API_KEY = "e0e760a968f8a592f4236264d1929081-us4"
MAILCHIMP_API_SERVER = "us4"
MAILCHIMP_AUDIENCE_ID = "77ab04b46d"
# MAILGUN_API_KEY is set as a secure secret via wrangler secret put

[env.staging]
name = "jvs-website-staging"

# KV Namespace for storing sensitive data like Mailgun API key
[[env.staging.kv_namespaces]]
binding = "JVS_SECRETS"
id = "7628564cb1e947908e46a7a47373c23b"

[env.staging.vars]
WP_GRAPHQL_URL = "https://backend.jvs.org.uk/graphql"
WP_API_URL = "https://backend.jvs.org.uk/wp-json/wp/v2"
WP_USERNAME = "your_wordpress_username"
WP_PASSWORD = "your_wordpress_password"
ALLOWED_ORIGIN = "https://staging.jvs.org.uk"
STRIPE_PUBLISHABLE_KEY = "pk_test_tUaoofuGHYYKl2YZprc5oEBs"
NEXT_PUBLIC_UNIFIED_EVENTS = "true"
MAILCHIMP_API_KEY = "e0e760a968f8a592f4236264d1929081-us4"
MAILCHIMP_API_SERVER = "us4"
MAILCHIMP_AUDIENCE_ID = "77ab04b46d"
# MAILGUN_API_KEY is set as a secure secret via wrangler secret put

[[env.staging.d1_databases]]
binding = "DB"
database_name = "jvs-magazine-db"
database_id = "2b2ca51b-2571-486a-b569-d595f75f9fd8"

 